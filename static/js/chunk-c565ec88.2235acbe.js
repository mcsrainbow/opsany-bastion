(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c565ec88"],{4246:function(t,e,a){"use strict";a.d(e,"g",(function(){return n})),a.d(e,"a",(function(){return i})),a.d(e,"e",(function(){return r})),a.d(e,"c",(function(){return o})),a.d(e,"h",(function(){return l})),a.d(e,"b",(function(){return c})),a.d(e,"f",(function(){return d})),a.d(e,"d",(function(){return u})),a.d(e,"j",(function(){return h})),a.d(e,"i",(function(){return p}));var s=a("b775"),n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host/",method:"get",params:t})},i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host/",method:"post",data:t})},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host/",method:"put",data:t})},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host/",method:"delete",data:t})},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-group/",method:"get",params:t})},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-group/",method:"post",data:t})},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-group/",method:"put",data:t})},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-group/",method:"delete",data:t})},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"host-credential/",method:"delete",data:t})},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"auth-host/",method:"get",params:t})}},"499a":function(t,e,a){"use strict";var s=a("a41e"),n=a.n(s);n.a},"688a":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"password_main"},[a("ContentHeader",[a("div",{attrs:{slot:"docs"},slot:"docs"},[t._v(" SSH密钥凭证支持设置密码，需要提前将公钥放置在对应用户家目录的.ssh/authorized_keys文件中。 ")])]),a("a-card",[a("div",{staticClass:"search_box"},[a("a-input-search",{staticStyle:{width:"200px"},attrs:{allowClear:"",placeholder:"请输入搜索名称"},on:{search:t.onSearch}}),t.$store.state.btnAuth.btnAuth.bastion_ssh_create?a("a-button",{staticStyle:{float:"right"},attrs:{icon:"plus",type:"primary"},on:{click:function(e){return t.$refs.AddSsh.show()}}},[t._v("新建")]):t._e()],1),a("a-table",{attrs:{loading:t.tableLoading,pagination:t.pagination,"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},columns:t.columns,"data-source":t.tableData},on:{change:t.onChange},scopedSlots:t._u([{key:"name",fn:function(e,s){return[t.$store.state.btnAuth.btnAuth.bastion_password_details?a("a",{attrs:{title:e},on:{click:function(e){return t.$router.push({path:"/voucher/ssh/sshDetails",query:{id:s.id}})}}},[t._v(t._s(e))]):a("span",{attrs:{title:e}},[t._v(t._s(e))])]}},{key:"login_type",fn:function(e){return[t._v(" "+t._s("auto"==e?"自动登录":"手动登录")+" ")]}},{key:"description",fn:function(e){return[t._v(" "+t._s(e||"--")+" ")]}},{key:"relation",fn:function(e,s){return[t.$store.state.btnAuth.btnAuth.bastion_password_details?a("a",{on:{click:function(e){return t.$router.push({path:"/voucher/ssh/sshDetails",query:{id:s.id}})}}},[t._v(t._s(e))]):a("span",[t._v(t._s(e))])]}},{key:"action",fn:function(e,s){return[t.$store.state.btnAuth.btnAuth.bastion_password_details?a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(e){return t.$router.push({path:"/voucher/ssh/sshDetails",query:{id:s.id}})}}},[t._v("查看")]):t._e(),t.$store.state.btnAuth.btnAuth.bastion_ssh_update?a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(e){return t.$refs.AddSsh.show(s)}}},[t._v("编辑")]):t._e(),t.$store.state.btnAuth.btnAuth.bastion_ssh_delete?a("a-button",{staticStyle:{color:"#333"},attrs:{size:"small",type:"link"},on:{click:function(e){return t.deletePassword(s)}}},[t._v("删除")]):t._e()]}}])}),t.tableData.length>0?a("a-button",{staticStyle:{float:"left",margin:"-50px 10px 0 0"},attrs:{disabled:0==t.selectedRowKeys.length},on:{click:t.batchDelete}},[t._v("批量删除")]):t._e()],1),a("AddSsh",{ref:"AddSsh",on:{father:function(e){return t.getCredentialData()}}})],1)},n=[],i=(a("d81d"),a("d3b7"),a("0977")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-drawer",{attrs:{"body-style":{paddingBottom:"80px"},width:"980px",title:t.title,placement:"right",visible:t.visible},on:{close:t.onClose}},[a("a-form",{attrs:{form:t.passwordForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-form-item",{attrs:{label:"凭证名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入凭证名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入凭证名称' }] }]"}],attrs:{placeholder:"请输入凭证名称"}})],1),a("a-form-item",{attrs:{label:"登录方式"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_type",{initialValue:"auto",rules:[{required:!0,message:"请选择登录方式"}]}],expression:"['login_type', { initialValue: 'auto' ,rules: [{ required: true, message: '请选择登录方式' }] }]"}],on:{change:t.loginTypeChange}},[a("a-radio",{attrs:{value:"auto"}},[t._v(" 自动登录 ")]),a("a-radio",{attrs:{value:"hand"}},[t._v(" 手动登录 ")])],1)],1),a("a-form-item",{attrs:{label:"资源账户"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["login_name",{rules:[{required:!0,message:"请输入资源账户"}]}],expression:"['login_name', { rules: [{ required: true , message: '请输入资源账户' }] }]"}],attrs:{placeholder:"请输入资源账户的名称"}})],1),a("a-form-item",{attrs:{label:"SSH key"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["ssh_key",{rules:[{required:!0,message:"请输入SSH key"}]}],expression:"['ssh_key', { rules: [{ required:true, message: '请输入SSH key' }] }]"}],attrs:{rows:4,placeholder:"请输入SSH key"}})],1),"auto"==t.loginType?[a("a-form-item",{attrs:{label:"Passphrase"}},[a("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["passphrase",{rules:[{required:!1,message:"请输入Passphrase"}]}],expression:"['passphrase', { rules: [{ required: false, message: '请输入Passphrase' }] }]"}],attrs:{placeholder:"请输入Passphrase"}})],1)]:t._e(),a("a-form-item",{attrs:{label:"描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1},{max:200,message:"最多输入200个汉字或字符"}]}],expression:"['description', { rules: [{ required: false},{max:200,message:'最多输入200个汉字或字符'}] }]"}],attrs:{placeholder:"请输入，最多输入200个汉字或字符"}})],1),a("a-form-item",{attrs:{label:"关联资源"}},[a("a-radio-group",{attrs:{"default-value":"a","button-style":"solid"}},[a("a-radio-button",{attrs:{value:"a"}},[t._v(" 主机资源 ")])],1)],1),a("a-transfer",{staticStyle:{margin:"0 0 0 8.33%"},attrs:{operations:t.operations,titles:t.titles,"list-style":t.listStyle,dataSource:t.mockData,targetKeys:t.targetKeys,"show-search":"",render:function(t){return t.title}},on:{change:t.handleChange}})],2),a("footer",[a("a-button",{on:{click:t.onClose}},[t._v("取消")]),a("a-button",{staticStyle:{margin:"0 0px 0 8px"},attrs:{loading:t.btnLoading,type:"primary"},on:{click:t.onSubmit}},[t._v("保存")])],1)],1)],1)},o=[],l=(a("a4d3"),a("e01a"),a("b0c0"),a("cb20")),c=a("4246"),d={data:function(){return{title:"",visible:!1,passwordForm:this.$form.createForm(this,{name:"passwordForm"}),mockData:[],targetKeys:["1"],isEdit:!1,btnLoading:!1,loginType:"auto",resources_type:"host",allhostList:[],hostList:[],selectedhostList:[],allappList:[],appList:[],selectedappList:[],listStyle:{width:"360px",height:"420px"},titles:["可选择的主机资源","已选择的的主机资源"],operations:["加入右侧","加入左侧"]}},mounted:function(){},methods:{loginTypeChange:function(t){this.loginType=t.target.value},show:function(t){if(this.getAllHost(),this.visible=!0,t){this.activePassword=t,this.isEdit=!0,this.title="编辑SSH密钥",this.loginType=t.login_type;var e=[];t.host_list.map((function(t){e.push(t.id+"")})),this.selectedhostList=e,this.targetKeys=this.selectedhostList,this.$nextTick((function(){this.passwordForm.setFieldsValue({name:t.name,login_type:t.login_type,ssh_key:"******",passphrase:"******",description:t.description,login_name:t.login_name})}))}else this.isEdit=!1,this.title="新建SSH密钥",this.loginType="auto"},getAllHost:function(){var t=this;Object(c["g"])({all_data:1}).then((function(e){if(200==e.code&&e.data){var a=[];e.data.map((function(t){a.push({key:t.id+"",title:t.host_name})})),t.allhostList=a,t.hostList=t.allhostList,t.mockData=t.hostList}}))},onClose:function(){this.visible=!1,this.passwordForm.resetFields(),this.$emit("father"),this.targetKeys=[],this.selectedhostList=[],this.selectedappList=[]},handleChange:function(t,e,a){this.targetKeys=t},onSubmit:function(){var t=this;this.passwordForm.validateFields((function(e,a){if(!e){t.btnLoading=!0;var s=a;s.credential_type="ssh_key","host"==t.resources_type?t.selectedhostList=t.targetKeys:t.selectedappList=t.targetKeys,s.host_list=t.selectedhostList,t.isEdit?(s.id=t.activePassword.id,Object(l["c"])(s).then((function(e){200==e.code&&(t.$message.success(e.message),t.onClose())})).finally((function(){t.btnLoading=!1}))):Object(l["a"])(s).then((function(e){200==e.code&&(t.$message.success(e.message),t.onClose())})).finally((function(){t.btnLoading=!1}))}}))}}},u=d,h=(a("69a9"),a("2877")),p=Object(h["a"])(u,r,o,!1,null,"0bf39215",null),g=p.exports,m={data:function(){return{tableData:[],columns:[{title:"凭证名称",dataIndex:"name",ellipsis:!0,scopedSlots:{customRender:"name"}},{title:"资源账户",dataIndex:"login_name",ellipsis:!0},{title:"登录方式",dataIndex:"login_type",ellipsis:!0,scopedSlots:{customRender:"login_type"}},{title:"关联主机",dataIndex:"relation",ellipsis:!0,scopedSlots:{customRender:"relation"}},{title:"描述",dataIndex:"description",ellipsis:!0,scopedSlots:{customRender:"description"}},{title:"操作",scopedSlots:{customRender:"action"},width:250,align:"center"}],selectedRowKeys:[],pagination:{total:0,current:1,pageSize:10,showTotal:function(t){return"共有 ".concat(t," 条数据")},search_type:"name",search_data:void 0,showSizeChanger:!0,showQuickJumper:!0},tableLoading:!1}},mounted:function(){this.getCredentialData()},methods:{onSearch:function(t){this.pagination.search_data=t,this.pagination.current=1,this.getCredentialData()},onChange:function(t){this.pagination.total=t.total,this.pagination.current=t.current,this.pagination.pageSize=t.pageSize,this.getCredentialData()},deletePassword:function(t){var e=this;this.$confirm({title:"确认删除该密码凭证吗？",onOk:function(){Object(l["b"])({id:t.id}).then((function(t){200==t.code&&(e.$message.success(t.message),e.getCredentialData())}))}})},batchDelete:function(){var t=this;this.$confirm({title:"确认删除吗？",onOk:function(){Object(l["b"])({id_list:t.selectedRowKeys}).then((function(e){200==e.code&&(t.$message.success(e.message),t.getCredentialData(),t.selectedRowKeys=[])}))}})},onSelectChange:function(t){this.selectedRowKeys=t},getCredentialData:function(){var t=this;this.tableLoading=!0;var e={current:this.pagination.current,pageSize:this.pagination.pageSize,credential_type:"ssh_key"};this.pagination.search_data&&(e.search_type="name",e.search_data=this.pagination.search_data),Object(l["d"])(e).then((function(e){200==e.code&&e.data?(t.pagination={total:e.data.total,current:e.data.current,pageSize:e.data.pageSize},e.data.data.map((function(t){t.key=t.id,t.relation=t.host_list.length})),t.tableData=e.data.data):t.tableData=[]})).finally((function(){t.tableLoading=!1}))}},components:{ContentHeader:i["a"],AddSsh:g}},f=m,b=(a("499a"),Object(h["a"])(f,s,n,!1,null,"13b47302",null));e["default"]=b.exports},"69a9":function(t,e,a){"use strict";var s=a("d22e"),n=a.n(s);n.a},a41e:function(t,e,a){},cb20:function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"a",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return o}));var s=a("b775"),n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential/",method:"get",params:t})},i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential/",method:"post",data:t})},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential/",method:"put",data:t})},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["b"])({url:"credential/",method:"delete",data:t})}},d22e:function(t,e,a){}}]);