(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-81aa5316"],{"5a80":function(t,a,e){"use strict";var n=e("9a23"),i=e.n(n);i.a},"9a23":function(t,a,e){},eb5b:function(t,a,e){"use strict";e.d(a,"g",(function(){return i})),e.d(a,"a",(function(){return o})),e.d(a,"e",(function(){return r})),e.d(a,"c",(function(){return s})),e.d(a,"h",(function(){return c})),e.d(a,"b",(function(){return d})),e.d(a,"f",(function(){return l})),e.d(a,"i",(function(){return u})),e.d(a,"d",(function(){return h}));var n=e("b775"),i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"resource/database/",method:"get",params:t})},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"resource/database/",method:"post",data:t})},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"resource/database/",method:"put",data:t})},s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"resource/database/",method:"delete",data:t})},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"group/database/",method:"get",params:t})},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"group/database/",method:"post",data:t})},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"group/database/",method:"put",data:t})},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"auth/database/",method:"get",params:t})},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"group/database/",method:"delete",data:t})}},f95f:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("ContentHeader",[e("div",{attrs:{slot:"docs"},slot:"docs"},[t._v(" 数据库资源用于通过堡垒机直接登录数据库，目前支持MySQL、MongoDB、Redis。 ")])]),e("a-card",[e("div",{staticClass:"content"},[e("div",{staticClass:"content_left"},[t.showTree?e("a-tree",{attrs:{selectedKeys:t.selectedKeys,defaultExpandAll:"","show-line":!0,treeData:t.treeData},on:{select:t.treeSelect},scopedSlots:t._u([{key:"action",fn:function(a){return[e("span",{staticClass:"treetitle",attrs:{title:a.title}},[t._v(t._s(a.title)+" ("+t._s(a.count)+")")])]}}],null,!1,43389017)}):e("a-spin")],1),e("div",{staticClass:"content_right"},[e("div",{staticClass:"top_search"},[e("div",[e("a-input-search",{staticStyle:{width:"320px"},attrs:{placeholder:"请输入关键字搜索",allowClear:""},on:{search:t.searchTable},model:{value:t.pagination.search_data,callback:function(a){t.$set(t.pagination,"search_data",a)},expression:"pagination.search_data"}},[e("a-select",{staticStyle:{width:"120px"},attrs:{slot:"addonBefore"},slot:"addonBefore",model:{value:t.pagination.search_type,callback:function(a){t.$set(t.pagination,"search_type",a)},expression:"pagination.search_type"}},t._l(t.searchList,(function(a){return e("a-select-option",{key:a.key},[t._v(t._s(a.name))])})),1)],1)],1),e("div",[e("a-button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"reload"},on:{click:t.refresh}},[t._v("刷新")])],1)]),e("a-table",{attrs:{loading:t.tableLoading,pagination:t.pagination,columns:t.columns,"data-source":t.tableData},on:{change:t.onChange},scopedSlots:t._u([{key:"action",fn:function(a,n){return[n.time_frame?e("a-button",{attrs:{size:"small",type:"link"},on:{click:function(a){return t.handleLogin(n)}}},[t._v("登录")]):e("a-tooltip",{attrs:{placement:"left",title:"由于访问策略限制，当前时段不允许登录。",overlayStyle:{maxWidth:"300px"},"arrow-point-at-center":""}},[e("a-button",{attrs:{disabled:"",size:"small",type:"link"},on:{click:function(a){return t.handleLogin(n)}}},[t._v("登录")])],1)]}}])})],1)])])],1)},i=[],o=(e("d81d"),e("b0c0"),e("d3b7"),e("eb5b")),r=e("0977"),s={data:function(){return{showTree:!0,selectedKeys:["all"],treeData:[{key:"all",title:"全部数据库",scopedSlots:{title:"action"},children:[]}],pagination:{total:0,current:1,pageSize:10,showTotal:function(t){return"共有 ".concat(t," 条数据")},showSizeChanger:!0,showQuickJumper:!0,search_type:"host_name",search_data:void 0},searchList:[{name:"数据库名称",key:"host_name"},{name:"连接地址",key:"host_address"},{name:"数据库类型",key:"database_type"}],tableData:[],columns:[{title:"数据库名称",dataIndex:"host_name",ellipsis:!0,scopedSlots:{customRender:"name"},width:220},{title:"连接地址",dataIndex:"host_address",ellipsis:!0},{title:"数据库类型",dataIndex:"database_type",ellipsis:!0},{title:"创建时间",dataIndex:"create_time",ellipsis:!0},{title:"操作",width:200,scopedSlots:{customRender:"action"},align:"center"}],tableLoading:!1,selectGroupId:void 0,fatherData:[]}},mounted:function(){this.getDataBaseData(),this.getDataBaseGroupData()},methods:{searchTable:function(t){this.search_data=t,this.pagination.current=1,this.getDataBaseData()},getDataBaseData:function(){var t=this;this.tableLoading=!0;var a={current:this.pagination.current,pageSize:this.pagination.pageSize};this.pagination.search_data&&(a.search_type=this.pagination.search_type,a.search_data=this.pagination.search_data),"all"!=this.selectGroupId&&(a.group_id=this.selectGroupId),Object(o["i"])(a).then((function(a){200==a.code&&a.data&&(t.pagination.total=a.data.total,t.pagination.current=a.data.current,t.pagination.pageSize=a.data.pageSize,a.data.data.map((function(t){t.key=t.id})),t.tableData=a.data.data)})).finally((function(){t.tableLoading=!1}))},getDataBaseGroupData:function(){var t=this;this.showTree=!1;var a=0;Object(o["h"])().then((function(e){function n(t,a){t.map((function(t){t.key=t.id,t.title=t.name,t.scopedSlots={title:"action"},t.layer=a,t.value=t.id,t.children&&t.children.length>0&&n(t.children,a+1)}))}200==e.code&&e.data&&(n(e.data,2),t.treeData[0].children=e.data,t.treeData[0].children.map((function(t){a+=t.count})),t.treeData[0].count=a,t.fatherData=e.data,t.showTree=!0)}))},treeSelect:function(t){this.selectGroupId=t[0],this.selectedKeys=t,this.pagination.current=1,this.getDataBaseData()},refresh:function(){this.pagination=this.$options.data().pagination,this.getDataBaseData()},onChange:function(t){this.pagination.total=t.total,this.pagination.current=t.current,this.pagination.pageSize=t.pageSize,this.getDataBaseData()}},components:{ContentHeader:r["a"]}},c=s,d=(e("5a80"),e("2877")),l=Object(d["a"])(c,n,i,!1,null,"1d8c499a",null);a["default"]=l.exports}}]);