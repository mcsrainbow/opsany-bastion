(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31241ef2"],{"1da1":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("d3b7");function n(t,e,a,n,i,s,r){try{var o=t[s](r),c=o.value}catch(l){return void a(l)}o.done?e(c):Promise.resolve(c).then(n,i)}function i(t){return function(){var e=this,a=arguments;return new Promise((function(i,s){var r=t.apply(e,a);function o(t){n(r,i,s,o,c,"next",t)}function c(t){n(r,i,s,o,c,"throw",t)}o(void 0)}))}}},"23ba":function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"e",(function(){return c}));var n=a("b775"),i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential-group/",method:"get",params:t})},s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential-group/",method:"post",data:t})},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential-group/",method:"put",data:t})},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential-group/",method:"delete",data:t})},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"group-credential/",method:"delete",data:t})}},"3d9e":function(t,e,a){"use strict";var n=a("5ac2"),i=a.n(n);i.a},"5ac2":function(t,e,a){},"62ac":function(t,e,a){"use strict";var n=a("6499"),i=a.n(n);i.a},6499:function(t,e,a){},"6f7c":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("d3b7");var n=a("a18c"),i=a("b775"),s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["b"])({url:"authentication/",method:"get",params:t})},r=function(){n["a"].push({name:"noAuth"})},o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise((function(a,n){setTimeout((function(){t.$loading.show()}),0),s({action_id:e}).then((function(t){return t.data||r(),a(t.data)})).catch((function(){return r(),a(!1)})).finally((function(){setTimeout((function(){t.$loading.hide()}),0)}))}))}},b647:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"group_main"},[a("ContentHeader",[a("div",{attrs:{slot:"docs"},slot:"docs"},[t._v("将凭证进行分组管理后可以直接关联到访问策略，适用于多账户同时关联场景。")])]),a("a-card",[a("div",{staticClass:"search_box"},[a("a-input-search",{staticStyle:{width:"200px"},attrs:{allowClear:"",placeholder:"请输入搜索名称"},on:{search:t.onSearch}}),t.$store.state.btnAuth.btnAuth.bastion_credential_group_create?a("a-button",{staticStyle:{float:"right"},attrs:{icon:"plus",type:"primary"},on:{click:function(e){return t.$refs.AddGroup.show()}}},[t._v("新建")]):t._e()],1),a("a-table",{attrs:{loading:t.tableLoading,pagination:t.pagination,"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},columns:t.columns,"data-source":t.tableData},on:{change:t.onChange},scopedSlots:t._u([{key:"name",fn:function(e,n){return[t.$store.state.btnAuth.btnAuth.bastion_password_details?a("a",{attrs:{title:e},on:{click:function(e){return t.$router.push({path:"/voucher/group/groupDetails",query:{id:n.id}})}}},[t._v(t._s(e))]):a("span",{attrs:{title:e}},[t._v(t._s(e))])]}},{key:"description",fn:function(e){return[t._v(" "+t._s(e||"--")+" ")]}},{key:"voucher",fn:function(e,n){return[t.$store.state.btnAuth.btnAuth.bastion_password_details?a("a",{on:{click:function(e){return t.$router.push({path:"/voucher/group/groupDetails",query:{id:n.id}})}}},[t._v(t._s(e))]):a("span",[t._v(t._s(e))])]}},{key:"action",fn:function(e,n){return[t.$store.state.btnAuth.btnAuth.bastion_password_details?a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(e){return t.$router.push({path:"/voucher/group/groupDetails",query:{id:n.id}})}}},[t._v("查看")]):t._e(),t.$store.state.btnAuth.btnAuth.bastion_credential_group_update?a("a-button",{attrs:{size:"small",type:"link"},on:{click:function(e){return t.$refs.AddGroup.show(n)}}},[t._v("编辑")]):t._e(),t.$store.state.btnAuth.btnAuth.bastion_credential_group_delete?a("a-button",{staticStyle:{color:"#333"},attrs:{size:"small",type:"link"},on:{click:function(e){return t.deleteGroup(n)}}},[t._v("删除")]):t._e()]}}])}),t.tableData.length>0?a("a-button",{staticStyle:{float:"left",margin:"-50px 10px 0 0"},attrs:{disabled:0==t.selectedRowKeys.length},on:{click:t.batchDelete}},[t._v("批量删除")]):t._e()],1),a("AddGroup",{ref:"AddGroup",on:{father:t.getGroupData}})],1)},i=[],s=(a("d81d"),a("d3b7"),a("96cf"),a("1da1")),r=a("0977"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-drawer",{attrs:{"body-style":{paddingBottom:"80px"},width:"980px",title:t.title,placement:"right",visible:t.visible},on:{close:t.onClose}},[a("a-form",{attrs:{form:t.groupForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-form-item",{attrs:{label:"分组名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入分组名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入分组名称' }] }]"}],attrs:{placeholder:"请输入分组名称"}})],1),a("a-form-item",{attrs:{label:"描述"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!1},{max:200,message:"最多输入200个汉字或字符"}]}],expression:"['description', { rules: [{ required: false},{max:200,message:'最多输入200个汉字或字符'}] }]"}],attrs:{placeholder:"请输入，最多输入200个汉字或字符"}})],1),a("a-form-item",{attrs:{label:"添加凭证"}},[a("a-radio-group",{attrs:{"button-style":"solid"},on:{change:t.credentialTypeChange},model:{value:t.credential_type,callback:function(e){t.credential_type=e},expression:"credential_type"}},[a("a-radio-button",{attrs:{value:"password"}},[t._v(" 密码凭证 ")]),a("a-radio-button",{attrs:{value:"ssh"}},[t._v(" SSH密钥 ")])],1)],1),a("a-transfer",{staticStyle:{margin:"0 0 0 8.33%"},attrs:{operations:t.operations,titles:t.titles,"list-style":t.listStyle,dataSource:t.mockData,targetKeys:t.targetKeys,"show-search":"",render:function(t){return t.title}},on:{change:t.handleChange}})],1),a("footer",[a("a-button",{staticStyle:{margin:"0 8px 0 0"},on:{click:t.onClose}},[t._v("取消")]),a("a-button",{attrs:{loading:t.btnLoading,type:"primary"},on:{click:t.onSubmit}},[t._v("保存")])],1)],1)],1)},c=[],l=(a("a4d3"),a("e01a"),a("b0c0"),a("23ba")),d=a("cb20"),u={data:function(){return{title:"",visible:!1,groupForm:this.$form.createForm(this,{name:"groupForm"}),mockData:[],targetKeys:[],btnLoading:!1,isEdit:!1,allpasswordList:[],passwordList:[],selectedpasswordList:[],allsshList:[],sshList:[],selectedsshList:[],credential_type:"password",listStyle:{width:"360px",height:"420px"},titles:[],titles1:["可添加的密码凭据","已选择的密码凭据"],titles2:["可添加的SSH密钥","已选择的SSH密钥"],operations:["加入右侧","加入左侧"]}},mounted:function(){},methods:{credentialTypeChange:function(t){"password"==t.target.value?(this.mockData=this.passwordList,this.selectedsshList=this.targetKeys,this.targetKeys=this.selectedpasswordList,this.titles=this.titles1):(this.mockData=this.sshList,this.selectedpasswordList=this.targetKeys,this.targetKeys=this.selectedsshList,this.titles=this.titles2)},getAllCredential:function(){var t=this;Object(d["d"])({all_data:"1",credential_type:"password"}).then((function(e){if(200==e.code&&e.data){var a=[];e.data.map((function(t){a.push({key:t.id+"",title:t.name})})),t.allpasswordList=a,t.passwordList=t.allpasswordList,t.mockData=t.passwordList}})),Object(d["d"])({all_data:"1",credential_type:"ssh_key"}).then((function(e){if(200==e.code&&e.data){var a=[];e.data.map((function(t){a.push({key:t.id+"",title:t.name})})),t.allsshList=a,t.sshList=t.allsshList}}))},show:function(t){if(this.getAllCredential(),this.visible=!0,this.titles=this.titles1,t){this.activeGroup=t,this.isEdit=!0,this.title="编辑凭证分组",this.loginType=t.login_type,this.$nextTick((function(){this.groupForm.setFieldsValue({name:t.name,login_type:t.login_type,login_name:t.login_name,login_password:t.login_password,description:t.description})}));var e=[],a=[];t.credential.password_credential.map((function(t){e.push(t.id+"")})),this.selectedpasswordList=e,t.credential.ssh_credential.map((function(t){a.push(t.id+"")})),this.selectedsshList=a,this.targetKeys=this.selectedpasswordList}else this.isEdit=!1,this.title="新建凭证分组"},onClose:function(){this.visible=!1,this.groupForm.resetFields(),this.targetKeys=[],this.selectedpasswordList=[],this.selectedsshList=[],this.credential_type="password",this.$emit("father")},handleChange:function(t,e,a){this.targetKeys=t},onSubmit:function(){var t=this;this.groupForm.validateFields((function(e,a){if(!e){t.btnLoading=!0;var n=a;"password"==t.credential_type?t.selectedpasswordList=t.targetKeys:t.selectedsshList=t.targetKeys,n.credential_password_list=t.selectedpasswordList,n.credential_ssh_list=t.selectedsshList,t.isEdit?(n.id=t.activeGroup.id,Object(l["c"])(n).then((function(e){200==e.code&&(t.$message.success(e.message),t.onClose())})).finally((function(){t.btnLoading=!1}))):Object(l["a"])(n).then((function(e){200==e.code&&(t.$message.success(e.message),t.onClose())})).finally((function(){t.btnLoading=!1}))}}))}}},h=u,p=(a("62ac"),a("2877")),g=Object(p["a"])(h,o,c,!1,null,"2bfcd38d",null),f=g.exports,m=a("6f7c"),b={data:function(){return{tableData:[],columns:[{title:"分组名称",dataIndex:"name",ellipsis:!0,scopedSlots:{customRender:"name"}},{title:"创建时间",dataIndex:"create_time",ellipsis:!0},{title:"关联的凭证",dataIndex:"voucher",ellipsis:!0,scopedSlots:{customRender:"voucher"}},{title:"描述",dataIndex:"description",ellipsis:!0,scopedSlots:{customRender:"description"}},{title:"操作",scopedSlots:{customRender:"action"},width:250,align:"center"}],selectedRowKeys:[],pagination:{total:0,current:1,pageSize:10,search_type:"name",search_data:void 0,showTotal:function(t){return"共有 ".concat(t," 条数据")},showSizeChanger:!0,showQuickJumper:!0},tableLoading:!1}},mounted:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(m["a"])(t,"visit-voucher-group");case 2:a=e.sent,a&&t.getGroupData();case 4:case"end":return e.stop()}}),e)})))()},methods:{onSearch:function(t){this.pagination.search_data=t,this.pagination.current=1,this.getGroupData()},batchDelete:function(){var t=this;this.$confirm({title:"确认删除吗？",onOk:function(){Object(l["b"])({id_list:t.selectedRowKeys}).then((function(e){200==e.code&&(t.$message.success(e.message),t.getGroupData(),t.selectedRowKeys=[])}))}})},onSelectChange:function(t){this.selectedRowKeys=t},getGroupData:function(){var t=this;this.tableLoading=!0;var e={current:this.pagination.current,pageSize:this.pagination.pageSize};this.pagination.search_data&&(e.search_type=this.pagination.search_type,e.search_data=this.pagination.search_data),Object(l["d"])(e).then((function(e){200==e.code&&e.data?(t.pagination.total=e.data.total,t.pagination.current=e.data.current,t.pagination.pageSize=e.data.pageSize,e.data.data.map((function(t){t.key=t.id,t.voucher=t.credential.password_credential.length+"/"+t.credential.ssh_credential.length})),t.tableData=e.data.data):t.tableData=[]})).finally((function(){t.tableLoading=!1}))},deleteGroup:function(t){var e=this;this.$confirm({title:"确认删除该分组吗？",onOk:function(){Object(l["b"])({id:t.id}).then((function(t){200==t.code&&(e.$message.success(t.message),e.getGroupData())}))}})},onChange:function(t){this.pagination.total=t.total,this.pagination.current=t.current,this.pagination.pageSize=t.pageSize,this.getGroupData()}},components:{ContentHeader:r["a"],AddGroup:f}},v=b,_=(a("3d9e"),Object(p["a"])(v,n,i,!1,null,"5053d367",null));e["default"]=_.exports},cb20:function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return o}));var n=a("b775"),i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential/",method:"get",params:t})},s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential/",method:"post",data:t})},r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential/",method:"put",data:t})},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(n["b"])({url:"credential/",method:"delete",data:t})}}}]);